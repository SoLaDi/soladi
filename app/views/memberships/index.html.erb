<h1>Mitgliedschaften</h1>

<script type="text/javascript">
    $(document).ready(function() {
        $('#rich-table').dataTable({
            ordering: true,
            rowGroup: {
                dataSrc: 3
            }
        });
    });
</script>

<table id="rich-table" class="table table-striped table-bordered">
  <thead>
  <tr>
    <th>ID</th>
    <th>Startdatum</th>
    <th>Enddatum</th>
    <th>Verteilerstelle</th>
    <th>Probezeit</th>
    <th>Totale Kosten</th>
    <th>Eingegangene Zahlungen</th>
    <th>Differenz</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
  </thead>

  <tbody>
  <% @fem.each do |fem| %>
    <tr>
      <td><%= fem.membership.id %></td>
      <td><%= fem.membership.startDate.strftime("%b %Y") %></td>
      <td><%= fem.membership.endDate ? fem.membership.endDate.strftime("%b %Y") : "" %></td>
      <td><%= link_to "#{fem.membership.distribution_point.name}", distribution_point_url(fem.membership.distribution_point.id) %></td>
      <td><%= fem.membership.is_trial_membership? ? "ja":"nein" %></td>
      <td><%= fem.total_cost %> EUR</td>
      <td><%= fem.total_payments %></td>
      <td><%= fem.total_payments - fem.total_cost %></td>

      <td><%= link_to 'Details', fem.membership %></td>
      <td><%= link_to 'Bearbeiten', edit_membership_path(fem.membership) %></td>
      <td><%= link_to 'LÃ¶schen', fem.membership, method: :delete, data: { confirm: 'Are you sure?' } %></td>
    </tr>
  <% end %>
  </tbody>
</table>

<br>

<%= link_to 'Neue Mitgliedschaft anlegen', new_membership_path %>

<br>
<br>

<div>
  <h3>Mitgliedschaften importieren</h3>
  <div class="alert alert-info" role="alert">
    CSV Datei (komma-getrennt) mit Feldern: membership_id, distribution_point_id
  </div>
  <%= form_tag import_memberships_path, multipart: true do %>
    <%= file_field_tag :file %>
    <%= submit_tag "CSV importieren" %>
  <% end %>
</div>
